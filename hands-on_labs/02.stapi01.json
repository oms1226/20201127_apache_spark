{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463787933_427067436","id":"20201127-075627_552831748","dateCreated":"2020-11-27T07:56:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8065","text":"%sh\nwget https://raw.githubusercontent.com/databricks/Spark-The-Definitive-Guide/master/data/flight-data/json/2015-summary.json","dateUpdated":"2020-11-27T07:56:43+0000","dateFinished":"2020-11-27T07:56:43+0000","dateStarted":"2020-11-27T07:56:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2020-11-27 07:56:43--  https://raw.githubusercontent.com/databricks/Spark-The-Definitive-Guide/master/data/flight-data/json/2015-summary.json\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 21368 (21K) [text/plain]\nSaving to: ‘2015-summary.json’\n\n     0K .......... ..........                                 100% 7.07M=0.003s\n\n2020-11-27 07:56:43 (7.07 MB/s) - ‘2015-summary.json’ saved [21368/21368]\n\n"}]}},{"text":"%sh\nhead /zeppelin/2015-summary.json","user":"anonymous","dateUpdated":"2020-11-27T07:56:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463803510_-615264639","id":"20201127-075643_1213486813","dateCreated":"2020-11-27T07:56:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8142","dateFinished":"2020-11-27T07:56:56+0000","dateStarted":"2020-11-27T07:56:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\"ORIGIN_COUNTRY_NAME\":\"Romania\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":15}\n{\"ORIGIN_COUNTRY_NAME\":\"Croatia\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":1}\n{\"ORIGIN_COUNTRY_NAME\":\"Ireland\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":344}\n{\"ORIGIN_COUNTRY_NAME\":\"United States\",\"DEST_COUNTRY_NAME\":\"Egypt\",\"count\":15}\n{\"ORIGIN_COUNTRY_NAME\":\"India\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":62}\n{\"ORIGIN_COUNTRY_NAME\":\"Singapore\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":1}\n{\"ORIGIN_COUNTRY_NAME\":\"Grenada\",\"DEST_COUNTRY_NAME\":\"United States\",\"count\":62}\n{\"ORIGIN_COUNTRY_NAME\":\"United States\",\"DEST_COUNTRY_NAME\":\"Costa Rica\",\"count\":588}\n{\"ORIGIN_COUNTRY_NAME\":\"United States\",\"DEST_COUNTRY_NAME\":\"Senegal\",\"count\":40}\n{\"ORIGIN_COUNTRY_NAME\":\"United States\",\"DEST_COUNTRY_NAME\":\"Moldova\",\"count\":1}\n"}]}},{"text":"%spark\n//json format을 바로 읽습니다\nval df = spark.read.format(\"json\").load(\"/zeppelin/2015-summary.json\")\n\n//데이터 스키마를 확인합니다\ndf.printSchema()\n","user":"anonymous","dateUpdated":"2020-11-27T07:57:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463816489_7616592","id":"20201127-075656_1910393628","dateCreated":"2020-11-27T07:56:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8243","dateFinished":"2020-11-27T07:57:29+0000","dateStarted":"2020-11-27T07:57:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- DEST_COUNTRY_NAME: string (nullable = true)\n |-- ORIGIN_COUNTRY_NAME: string (nullable = true)\n |-- count: long (nullable = true)\n\ndf: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=46"],"interpreterSettingId":"spark"}}},{"text":"%spark\nimport org.apache.spark.sql.types.{StructField, StructType, StringType, LongType}\nimport org.apache.spark.sql.types.Metadata\n\n//다음과 같이 스키마를 지정하여 필요한 데이터만 데이터 프레임으로 로딩할 수 있습니다\nval myManualSchema = StructType(Array(\n  StructField(\"DEST_COUNTRY_NAME\", StringType, true),\n  StructField(\"ORIGIN_COUNTRY_NAME\", StringType, true),\n  StructField(\"count\", LongType, false,\n    Metadata.fromJson(\"{\\\"hello\\\":\\\"world\\\"}\"))\n))\n\n\n//스키마를 통해 필요 데이터만 데이터 프레임에 로딩합니다\nval df = spark.read.format(\"json\").schema(myManualSchema)\n  .load(\"/zeppelin/2015-summary.json\")","user":"anonymous","dateUpdated":"2020-11-27T07:58:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463848702_952819460","id":"20201127-075728_2116240673","dateCreated":"2020-11-27T07:57:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8331","dateFinished":"2020-11-27T07:58:13+0000","dateStarted":"2020-11-27T07:58:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.{StructField, StructType, StringType, LongType}\nimport org.apache.spark.sql.types.Metadata\nmyManualSchema: org.apache.spark.sql.types.StructType = StructType(StructField(DEST_COUNTRY_NAME,StringType,true), StructField(ORIGIN_COUNTRY_NAME,StringType,true), StructField(count,LongType,false))\ndf: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n"}]}},{"text":"%spark\n//데이터 프레임을 확인합니다\ndf.show()","user":"anonymous","dateUpdated":"2020-11-27T07:59:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463893111_1775168900","id":"20201127-075813_1815632523","dateCreated":"2020-11-27T07:58:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8444","dateFinished":"2020-11-27T07:59:10+0000","dateStarted":"2020-11-27T07:59:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-----+\n|   DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+--------------------+-------------------+-----+\n|       United States|            Romania|   15|\n|       United States|            Croatia|    1|\n|       United States|            Ireland|  344|\n|               Egypt|      United States|   15|\n|       United States|              India|   62|\n|       United States|          Singapore|    1|\n|       United States|            Grenada|   62|\n|          Costa Rica|      United States|  588|\n|             Senegal|      United States|   40|\n|             Moldova|      United States|    1|\n|       United States|       Sint Maarten|  325|\n|       United States|   Marshall Islands|   39|\n|              Guyana|      United States|   64|\n|               Malta|      United States|    1|\n|            Anguilla|      United States|   41|\n|             Bolivia|      United States|   30|\n|       United States|           Paraguay|    6|\n|             Algeria|      United States|    4|\n|Turks and Caicos ...|      United States|  230|\n|       United States|          Gibraltar|    1|\n+--------------------+-------------------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=47"],"interpreterSettingId":"spark"}}},{"text":"%spark\n//컬럼 정보를 추출합니다\nspark.read.format(\"json\").load(\"/zeppelin/2015-summary.json\").columns\n","user":"anonymous","dateUpdated":"2020-11-27T07:59:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463949998_-1519230804","id":"20201127-075909_1037596207","dateCreated":"2020-11-27T07:59:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8541","dateFinished":"2020-11-27T07:59:36+0000","dateStarted":"2020-11-27T07:59:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res25: Array[String] = Array(DEST_COUNTRY_NAME, ORIGIN_COUNTRY_NAME, count)\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=48"],"interpreterSettingId":"spark"}}},{"text":"%spark\n//첫번째 row만 가져옵니다\ndf.first()\n","user":"anonymous","dateUpdated":"2020-11-27T07:59:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463976041_-1719144214","id":"20201127-075936_2077303748","dateCreated":"2020-11-27T07:59:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8654","dateFinished":"2020-11-27T07:59:52+0000","dateStarted":"2020-11-27T07:59:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res26: org.apache.spark.sql.Row = [United States,Romania,15]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=49"],"interpreterSettingId":"spark"}}},{"text":"%spark\n//임의의 row를 생성하고 확인합니다\nimport org.apache.spark.sql.Row\nval myRow = Row(\"Hello\", null, 1, false)","user":"anonymous","dateUpdated":"2020-11-27T08:00:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606463991801_-1589979440","id":"20201127-075951_220674148","dateCreated":"2020-11-27T07:59:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8767","dateFinished":"2020-11-27T08:00:04+0000","dateStarted":"2020-11-27T08:00:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.Row\nmyRow: org.apache.spark.sql.Row = [Hello,null,1,false]\n"}]}},{"text":"%spark\n//Row의 0번째 값을 가져옵니다\nmyRow(0)","user":"anonymous","dateUpdated":"2020-11-27T08:00:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606464003577_-1311951441","id":"20201127-080003_1924168189","dateCreated":"2020-11-27T08:00:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8880","dateFinished":"2020-11-27T08:00:12+0000","dateStarted":"2020-11-27T08:00:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res27: Any = Hello\n"}]}},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-11-27T08:00:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606464011838_-1595183073","id":"20201127-080011_654546487","dateCreated":"2020-11-27T08:00:11+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8977"}],"name":"02.stapi01","id":"2FR48R6CE","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}