{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606457992363_1544191573","id":"20201127-061952_195688826","dateCreated":"2020-11-27T06:19:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3037","text":"spark","dateUpdated":"2020-11-27T06:20:04+0000","dateFinished":"2020-11-27T06:20:35+0000","dateStarted":"2020-11-27T06:20:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res1: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7fb08b84\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606457897238_1110902285","id":"20201127-061817_279213975","dateCreated":"2020-11-27T06:18:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2941","text":"val myRange = spark.range(1000).toDF(\"number\")","dateUpdated":"2020-11-27T06:22:38+0000","dateFinished":"2020-11-27T06:22:43+0000","dateStarted":"2020-11-27T06:22:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myRange: org.apache.spark.sql.DataFrame = [number: bigint]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458158252_-80323816","id":"20201127-062238_245224002","dateCreated":"2020-11-27T06:22:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3138","text":"val divisBy2 = myRange.where(\"number % 2 = 0\")","dateUpdated":"2020-11-27T06:22:56+0000","dateFinished":"2020-11-27T06:22:57+0000","dateStarted":"2020-11-27T06:22:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"divisBy2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [number: bigint]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458176661_104692742","id":"20201127-062256_1676299265","dateCreated":"2020-11-27T06:22:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3235","text":"divisBy2.count()","dateUpdated":"2020-11-27T06:23:07+0000","dateFinished":"2020-11-27T06:23:12+0000","dateStarted":"2020-11-27T06:23:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: Long = 500\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=0"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458187288_-653694976","id":"20201127-062307_8106594","dateCreated":"2020-11-27T06:23:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3332","text":"%sh\nwget https://raw.githubusercontent.com/databricks/Spark-The-Definitive-Guide/master/data/flight-data/csv/2015-summary.csv","dateUpdated":"2020-11-27T06:23:31+0000","dateFinished":"2020-11-27T06:23:35+0000","dateStarted":"2020-11-27T06:23:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2020-11-27 06:23:35--  https://raw.githubusercontent.com/databricks/Spark-The-Definitive-Guide/master/data/flight-data/csv/2015-summary.csv\nResolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.0.133, 151.101.64.133, 151.101.128.133, ...\nConnecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.0.133|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 7080 (6.9K) [text/plain]\nSaving to: ‘2015-summary.csv’\n\n     0K ......                                                100% 4.02M=0.002s\n\n2020-11-27 06:23:35 (4.02 MB/s) - ‘2015-summary.csv’ saved [7080/7080]\n\n"}]}},{"text":"%sh\nhead /zeppelin/2015-summary.csv","user":"anonymous","dateUpdated":"2020-11-27T06:23:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458211345_-1563216821","id":"20201127-062331_1095165353","dateCreated":"2020-11-27T06:23:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3447","dateFinished":"2020-11-27T06:23:44+0000","dateStarted":"2020-11-27T06:23:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DEST_COUNTRY_NAME,ORIGIN_COUNTRY_NAME,count\nUnited States,Romania,15\nUnited States,Croatia,1\nUnited States,Ireland,344\nEgypt,United States,15\nUnited States,India,62\nUnited States,Singapore,1\nUnited States,Grenada,62\nCosta Rica,United States,588\nSenegal,United States,40\n"}]}},{"text":"%spark\nval flightData2015 = spark.read.option(\"inferSchema\", \"true\").option(\"header\", \"true\").csv(\"/zeppelin/2015-summary.csv\")","user":"anonymous","dateUpdated":"2020-11-27T06:24:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458224505_-966172401","id":"20201127-062344_321158285","dateCreated":"2020-11-27T06:23:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3544","dateFinished":"2020-11-27T06:24:14+0000","dateStarted":"2020-11-27T06:24:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flightData2015: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1","http://172.17.0.2:4040/jobs/job?id=2"],"interpreterSettingId":"spark"}}},{"text":"%spark\nflightData2015.take(3)","user":"anonymous","dateUpdated":"2020-11-27T06:24:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458251770_1281860549","id":"20201127-062411_1011774941","dateCreated":"2020-11-27T06:24:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3632","dateFinished":"2020-11-27T06:24:33+0000","dateStarted":"2020-11-27T06:24:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: Array[org.apache.spark.sql.Row] = Array([United States,Romania,15], [United States,Croatia,1], [United States,Ireland,344])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"text":"%spark\nflightData2015.sort(\"count\").explain()","user":"anonymous","dateUpdated":"2020-11-27T06:24:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458272275_1190673240","id":"20201127-062432_324696606","dateCreated":"2020-11-27T06:24:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3749","dateFinished":"2020-11-27T06:24:43+0000","dateStarted":"2020-11-27T06:24:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\n*Sort [count#29 ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(count#29 ASC NULLS FIRST, 200)\n   +- *FileScan csv [DEST_COUNTRY_NAME#27,ORIGIN_COUNTRY_NAME#28,count#29] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/zeppelin/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:int>\n"}]}},{"text":"%spark\nflightData2015.sort(\"count\").take(2)","user":"anonymous","dateUpdated":"2020-11-27T06:24:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458282306_1794038015","id":"20201127-062442_1491377495","dateCreated":"2020-11-27T06:24:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3862","dateFinished":"2020-11-27T06:24:52+0000","dateStarted":"2020-11-27T06:24:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res5: Array[org.apache.spark.sql.Row] = Array([United States,Singapore,1], [Moldova,United States,1])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"text":"%spark\nflightData2015.createOrReplaceTempView(\"flight_data_2015\")","user":"anonymous","dateUpdated":"2020-11-27T06:25:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458291913_858316019","id":"20201127-062451_177105990","dateCreated":"2020-11-27T06:24:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3959","dateFinished":"2020-11-27T06:25:03+0000","dateStarted":"2020-11-27T06:25:02+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark\nval sqlWay = spark.sql(\"\"\"\nSELECT DEST_COUNTRY_NAME, count(1)\nFROM flight_data_2015\nGROUP BY DEST_COUNTRY_NAME\n\"\"\")","user":"anonymous","dateUpdated":"2020-11-27T06:25:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458302778_1115373747","id":"20201127-062502_1561925945","dateCreated":"2020-11-27T06:25:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4072","dateFinished":"2020-11-27T06:25:17+0000","dateStarted":"2020-11-27T06:25:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sqlWay: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, count(1): bigint]\n"}]}},{"text":"%sql\nSELECT DEST_COUNTRY_NAME, count(1)\nFROM flight_data_2015\nGROUP BY DEST_COUNTRY_NAME\n","user":"anonymous","dateUpdated":"2020-11-27T06:40:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"DEST_COUNTRY_NAME":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"DEST_COUNTRY_NAME","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(1)","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606459218586_-646487503","id":"20201127-064018_39806118","dateCreated":"2020-11-27T06:40:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5945","dateFinished":"2020-11-27T06:40:43+0000","dateStarted":"2020-11-27T06:40:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"DEST_COUNTRY_NAME\tcount(1)\nAnguilla\t1\nRussia\t1\nParaguay\t1\nSenegal\t1\nSweden\t1\nKiribati\t1\nGuyana\t1\nPhilippines\t1\nDjibouti\t1\nMalaysia\t1\nSingapore\t1\nFiji\t1\nTurkey\t1\nIraq\t1\nGermany\t1\nJordan\t1\nPalau\t1\nTurks and Caicos Islands\t1\nFrance\t1\nGreece\t1\nKosovo\t1\nTaiwan\t1\nBritish Virgin Islands\t1\nDominica\t1\nAlgeria\t1\nArgentina\t1\nBelgium\t1\nAngola\t1\nEcuador\t1\nQatar\t1\nFinland\t1\nNew Caledonia\t1\nNicaragua\t1\nGhana\t1\nPeru\t1\nUnited States\t125\nIndia\t1\nChina\t1\nCuracao\t1\nMalta\t1\nKuwait\t1\nMarshall Islands\t1\nChile\t1\nMartinique\t1\nCayman Islands\t1\nCroatia\t1\nBolivia\t1\nNigeria\t1\nItaly\t1\nSuriname\t1\nNorway\t1\nSpain\t1\nCuba\t1\nGuadeloupe\t1\nDenmark\t1\nNiger\t1\nBarbados\t1\nIreland\t1\nThailand\t1\nMorocco\t1\nPanama\t1\nCape Verde\t1\nHong Kong\t1\nVenezuela\t1\nUkraine\t1\nIceland\t1\nIsrael\t1\nSaint Barthelemy\t1\nSaint Kitts and Nevis\t1\nFrench Polynesia\t1\nSouth Korea\t1\nCyprus\t1\nUruguay\t1\nBonaire, Sint Eustatius, and Saba\t1\nMexico\t1\nCote d'Ivoire\t1\nAruba\t1\nGeorgia\t1\nIndonesia\t1\nSaint Vincent and the Grenadines\t1\nThe Bahamas\t1\nGuatemala\t1\nAzerbaijan\t1\nSint Maarten\t1\nGrenada\t1\nFederated States of Micronesia\t1\nLiberia\t1\nTunisia\t1\nHonduras\t1\nTrinidad and Tobago\t1\nSaudi Arabia\t1\nFrench Guiana\t1\nSwitzerland\t1\nZambia\t1\nEthiopia\t1\nLatvia\t1\nJamaica\t1\nUnited Arab Emirates\t1\nSaint Lucia\t1\nCanada\t1\nSamoa\t1\nCzech Republic\t1\nCook Islands\t1\nBrazil\t1\nBelize\t1\nAntigua and Barbuda\t1\nDominican Republic\t1\nJapan\t1\nLuxembourg\t1\nNew Zealand\t1\nGreenland\t1\nHaiti\t1\nPoland\t1\nPortugal\t1\nPapua New Guinea\t1\nAustralia\t1\nRomania\t1\nBulgaria\t1\nAustria\t1\nEgypt\t1\nCosta Rica\t1\nEl Salvador\t1\nBurkina Faso\t1\nSouth Africa\t1\nBermuda\t1\nBahrain\t1\nColombia\t1\nHungary\t1\nPakistan\t1\nMoldova\t1\nUnited Kingdom\t1\nNetherlands\t1\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=36","http://172.17.0.2:4040/jobs/job?id=37","http://172.17.0.2:4040/jobs/job?id=38","http://172.17.0.2:4040/jobs/job?id=39","http://172.17.0.2:4040/jobs/job?id=40"],"interpreterSettingId":"spark"}}},{"text":"%spark\nsqlWay.describe().show()","user":"anonymous","dateUpdated":"2020-11-27T06:25:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458316820_-1607318199","id":"20201127-062516_477758026","dateCreated":"2020-11-27T06:25:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4153","dateFinished":"2020-11-27T06:25:39+0000","dateStarted":"2020-11-27T06:25:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+------------------+\n|summary|DEST_COUNTRY_NAME|          count(1)|\n+-------+-----------------+------------------+\n|  count|              132|               132|\n|   mean|             null|1.9393939393939394|\n| stddev|             null|10.792814669253264|\n|    min|          Algeria|                 1|\n|    max|           Zambia|               125|\n+-------+-----------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval dataFrameWay = flightData2015\n  .groupBy('DEST_COUNTRY_NAME)\n  .count.explain","user":"anonymous","dateUpdated":"2020-11-27T06:25:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458324812_-1208104149","id":"20201127-062524_439198207","dateCreated":"2020-11-27T06:25:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4250","dateFinished":"2020-11-27T06:25:47+0000","dateStarted":"2020-11-27T06:25:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#27, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[partial_count(1)])\n      +- *FileScan csv [DEST_COUNTRY_NAME#27] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/zeppelin/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string>\ndataFrameWay: Unit = ()\n"}]}},{"text":"%spark\nsqlWay.explain","user":"anonymous","dateUpdated":"2020-11-27T06:26:05+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458346383_-493762092","id":"20201127-062546_787294764","dateCreated":"2020-11-27T06:25:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4367","dateFinished":"2020-11-27T06:26:06+0000","dateStarted":"2020-11-27T06:26:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\n*HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[count(1)])\n+- Exchange hashpartitioning(DEST_COUNTRY_NAME#27, 200)\n   +- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[partial_count(1)])\n      +- *FileScan csv [DEST_COUNTRY_NAME#27] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/zeppelin/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string>\n"}]}},{"text":"%spark\nspark.sql(\"SELECT max(count) from flight_data_2015\").take(1)","user":"anonymous","dateUpdated":"2020-11-27T06:26:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458365692_-147266227","id":"20201127-062605_1690233988","dateCreated":"2020-11-27T06:26:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4464","dateFinished":"2020-11-27T06:26:13+0000","dateStarted":"2020-11-27T06:26:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res9: Array[org.apache.spark.sql.Row] = Array([370002])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"%spark\nimport org.apache.spark.sql.functions.max\n\nflightData2015.select(max(\"count\")).take(1)","user":"anonymous","dateUpdated":"2020-11-27T06:26:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458372354_-135863897","id":"20201127-062612_1062360829","dateCreated":"2020-11-27T06:26:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4561","dateFinished":"2020-11-27T06:26:23+0000","dateStarted":"2020-11-27T06:26:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.functions.max\nres10: Array[org.apache.spark.sql.Row] = Array([370002])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval maxSql = spark.sql(\"\"\"\nSELECT DEST_COUNTRY_NAME, sum(count) as destination_total\nFROM flight_data_2015\nGROUP BY DEST_COUNTRY_NAME\nORDER BY sum(count) DESC\nLIMIT 5\n\"\"\")","user":"anonymous","dateUpdated":"2020-11-27T06:26:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458382801_-1793964737","id":"20201127-062622_843139036","dateCreated":"2020-11-27T06:26:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4674","dateFinished":"2020-11-27T06:26:33+0000","dateStarted":"2020-11-27T06:26:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"maxSql: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, destination_total: bigint]\n"}]}},{"text":"%spark\nmaxSql.explain\nmaxSql.show()\n","user":"anonymous","dateUpdated":"2020-11-27T06:27:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458401107_1550266162","id":"20201127-062641_971762454","dateCreated":"2020-11-27T06:26:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4884","dateFinished":"2020-11-27T06:27:08+0000","dateStarted":"2020-11-27T06:27:01+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\nTakeOrderedAndProject(limit=5, orderBy=[aggOrder#227L DESC NULLS LAST], output=[DEST_COUNTRY_NAME#27,destination_total#218L])\n+- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[sum(cast(count#29 as bigint)), sum(cast(count#29 as bigint))])\n   +- Exchange hashpartitioning(DEST_COUNTRY_NAME#27, 200)\n      +- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[partial_sum(cast(count#29 as bigint)), partial_sum(cast(count#29 as bigint))])\n         +- *FileScan csv [DEST_COUNTRY_NAME#27,count#29] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/zeppelin/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string,count:int>\n+-----------------+-----------------+\n|DEST_COUNTRY_NAME|destination_total|\n+-----------------+-----------------+\n|    United States|           411352|\n|           Canada|             8399|\n|           Mexico|             7140|\n|   United Kingdom|             2025|\n|            Japan|             1548|\n+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"%spark\nflightData2015\n.groupBy(\"DEST_COUNTRY_NAME\")\n.sum(\"count\")\n.withColumnRenamed(\"sum(count)\", \"destination_total\")\n.sort(desc(\"destination_total\"))\n.limit(5)\n.explain","user":"anonymous","dateUpdated":"2020-11-27T06:27:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458421690_831798676","id":"20201127-062701_1814678824","dateCreated":"2020-11-27T06:27:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4979","dateFinished":"2020-11-27T06:27:12+0000","dateStarted":"2020-11-27T06:27:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\nTakeOrderedAndProject(limit=5, orderBy=[destination_total#252L DESC NULLS LAST], output=[DEST_COUNTRY_NAME#27,destination_total#252L])\n+- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[sum(cast(count#29 as bigint))])\n   +- Exchange hashpartitioning(DEST_COUNTRY_NAME#27, 200)\n      +- *HashAggregate(keys=[DEST_COUNTRY_NAME#27], functions=[partial_sum(cast(count#29 as bigint))])\n         +- *FileScan csv [DEST_COUNTRY_NAME#27,count#29] Batched: false, Format: CSV, Location: InMemoryFileIndex[file:/zeppelin/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string,count:int>\n"}]}},{"text":"%spark\nflightData2015\n.groupBy(\"DEST_COUNTRY_NAME\")\n.sum(\"count\")\n.withColumnRenamed(\"sum(count)\", \"destination_total\")\n.sort(desc(\"destination_total\"))\n.limit(5)\n.show()","user":"anonymous","dateUpdated":"2020-11-27T06:27:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458431602_-1707475666","id":"20201127-062711_950023557","dateCreated":"2020-11-27T06:27:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5094","dateFinished":"2020-11-27T06:27:26+0000","dateStarted":"2020-11-27T06:27:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-----------------+\n|DEST_COUNTRY_NAME|destination_total|\n+-----------------+-----------------+\n|    United States|           411352|\n|           Canada|             8399|\n|           Mexico|             7140|\n|   United Kingdom|             2025|\n|            Japan|             1548|\n+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval data = Seq((\"Banana\",1000,\"USA\"), (\"Carrots\",1500,\"USA\"), (\"Beans\",1600,\"USA\"),\n      (\"Orange\",2000,\"USA\"),(\"Orange\",2000,\"USA\"),(\"Banana\",400,\"China\"),\n      (\"Carrots\",1200,\"China\"),(\"Beans\",1500,\"China\"),(\"Orange\",4000,\"China\"),\n      (\"Banana\",2000,\"Canada\"),(\"Carrots\",2000,\"Canada\"),(\"Beans\",2000,\"Mexico\"))\n\nimport spark.sqlContext.implicits._\nval df = data.toDF(\"Product\",\"Amount\",\"Country\")\ndf.show()","user":"anonymous","dateUpdated":"2020-11-27T06:27:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458439928_-387982452","id":"20201127-062719_841277549","dateCreated":"2020-11-27T06:27:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5191","dateFinished":"2020-11-27T06:27:33+0000","dateStarted":"2020-11-27T06:27:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-------+\n|Product|Amount|Country|\n+-------+------+-------+\n| Banana|  1000|    USA|\n|Carrots|  1500|    USA|\n|  Beans|  1600|    USA|\n| Orange|  2000|    USA|\n| Orange|  2000|    USA|\n| Banana|   400|  China|\n|Carrots|  1200|  China|\n|  Beans|  1500|  China|\n| Orange|  4000|  China|\n| Banana|  2000| Canada|\n|Carrots|  2000| Canada|\n|  Beans|  2000| Mexico|\n+-------+------+-------+\n\ndata: Seq[(String, Int, String)] = List((Banana,1000,USA), (Carrots,1500,USA), (Beans,1600,USA), (Orange,2000,USA), (Orange,2000,USA), (Banana,400,China), (Carrots,1200,China), (Beans,1500,China), (Orange,4000,China), (Banana,2000,Canada), (Carrots,2000,Canada), (Beans,2000,Mexico))\nimport spark.sqlContext.implicits._\ndf: org.apache.spark.sql.DataFrame = [Product: string, Amount: int ... 1 more field]\n"}]}},{"text":"%spark\nval pivotDF = df.groupBy(\"Product\").pivot(\"Country\").sum(\"Amount\")\npivotDF.show()","user":"anonymous","dateUpdated":"2020-11-27T06:27:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458449396_861141123","id":"20201127-062729_1520007706","dateCreated":"2020-11-27T06:27:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5306","dateFinished":"2020-11-27T06:28:00+0000","dateStarted":"2020-11-27T06:27:42+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+------+----+\n|Product|Canada|China|Mexico| USA|\n+-------+------+-----+------+----+\n| Orange|  null| 4000|  null|4000|\n|  Beans|  null| 1500|  2000|1600|\n| Banana|  2000|  400|  null|1000|\n|Carrots|  2000| 1200|  null|1500|\n+-------+------+-----+------+----+\n\npivotDF: org.apache.spark.sql.DataFrame = [Product: string, Canada: bigint ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=10","http://172.17.0.2:4040/jobs/job?id=11","http://172.17.0.2:4040/jobs/job?id=12","http://172.17.0.2:4040/jobs/job?id=13","http://172.17.0.2:4040/jobs/job?id=14","http://172.17.0.2:4040/jobs/job?id=15","http://172.17.0.2:4040/jobs/job?id=16","http://172.17.0.2:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval countries = Seq(\"USA\",\"China\",\"Canada\",\"Mexico\")\nval pivotDF = df.groupBy(\"Product\").pivot(\"Country\", countries).sum(\"Amount\")\npivotDF.show()","user":"anonymous","dateUpdated":"2020-11-27T06:27:52+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458462246_-1662881026","id":"20201127-062742_1162592578","dateCreated":"2020-11-27T06:27:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5403","dateFinished":"2020-11-27T06:28:09+0000","dateStarted":"2020-11-27T06:27:53+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----+-----+------+------+\n|Product| USA|China|Canada|Mexico|\n+-------+----+-----+------+------+\n| Orange|4000| 4000|  null|  null|\n|  Beans|1600| 1500|  null|  2000|\n| Banana|1000|  400|  2000|  null|\n|Carrots|1500| 1200|  2000|  null|\n+-------+----+-----+------+------+\n\ncountries: Seq[String] = List(USA, China, Canada, Mexico)\npivotDF: org.apache.spark.sql.DataFrame = [Product: string, USA: bigint ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=18","http://172.17.0.2:4040/jobs/job?id=19","http://172.17.0.2:4040/jobs/job?id=20","http://172.17.0.2:4040/jobs/job?id=21","http://172.17.0.2:4040/jobs/job?id=22"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval pivotDF = df.groupBy(\"Product\",\"Country\")\n      .sum(\"Amount\")\n      .groupBy(\"Product\")\n      .pivot(\"Country\")\n      .sum(\"sum(Amount)\")\npivotDF.show()","user":"anonymous","dateUpdated":"2020-11-27T06:28:15+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458472782_317543374","id":"20201127-062752_712253087","dateCreated":"2020-11-27T06:27:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5508","dateFinished":"2020-11-27T06:28:34+0000","dateStarted":"2020-11-27T06:28:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------+-----+------+----+\n|Product|Canada|China|Mexico| USA|\n+-------+------+-----+------+----+\n| Orange|  null| 4000|  null|4000|\n|  Beans|  null| 1500|  2000|1600|\n| Banana|  2000|  400|  null|1000|\n|Carrots|  2000| 1200|  null|1500|\n+-------+------+-----+------+----+\n\npivotDF: org.apache.spark.sql.DataFrame = [Product: string, Canada: bigint ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=23","http://172.17.0.2:4040/jobs/job?id=24","http://172.17.0.2:4040/jobs/job?id=25","http://172.17.0.2:4040/jobs/job?id=26","http://172.17.0.2:4040/jobs/job?id=27","http://172.17.0.2:4040/jobs/job?id=28","http://172.17.0.2:4040/jobs/job?id=29","http://172.17.0.2:4040/jobs/job?id=30"],"interpreterSettingId":"spark"}}},{"text":"%spark\nval unPivotDF = pivotDF.select($\"Product\",\nexpr(\"stack(4, 'Canada', Canada, 'China', China, 'Mexico', Mexico, 'USA', USA) as (Country,Total)\"))\n.where(\"Total is not null\")\nunPivotDF.show()","user":"anonymous","dateUpdated":"2020-11-27T06:28:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458495157_1103957710","id":"20201127-062815_1924683830","dateCreated":"2020-11-27T06:28:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5655","dateFinished":"2020-11-27T06:28:43+0000","dateStarted":"2020-11-27T06:28:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|Product|Country|Total|\n+-------+-------+-----+\n| Orange|  China| 4000|\n| Orange|    USA| 4000|\n|  Beans|  China| 1500|\n|  Beans| Mexico| 2000|\n|  Beans|    USA| 1600|\n| Banana| Canada| 2000|\n| Banana|  China|  400|\n| Banana|    USA| 1000|\n|Carrots| Canada| 2000|\n|Carrots|  China| 1200|\n|Carrots|    USA| 1500|\n+-------+-------+-----+\n\nunPivotDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Product: string, Country: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=31","http://172.17.0.2:4040/jobs/job?id=32","http://172.17.0.2:4040/jobs/job?id=33","http://172.17.0.2:4040/jobs/job?id=34","http://172.17.0.2:4040/jobs/job?id=35"],"interpreterSettingId":"spark"}}},{"text":"%spark\n","user":"anonymous","dateUpdated":"2020-11-27T06:28:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1606458503504_295060489","id":"20201127-062823_1258869310","dateCreated":"2020-11-27T06:28:23+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5760"}],"name":"start","id":"2FSP3HW9P","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}